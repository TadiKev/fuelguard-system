sequenceDiagram
  participant Attendant
  participant Frontend
  participant Backend
  participant Redis
  participant Celery
  participant DB
  participant Channels

  Attendant->>Frontend: Enter sale (pump, volume)
  Frontend->>Backend: POST /api/v1/transactions/ (transaction event)
  Backend->>DB: Insert Transaction (status: pending)
  Backend->>Redis: Publish transaction.created
  Redis->>Celery: queued
  Celery->>Backend: call rule-engine(transaction)
  Celery->>DB: Update Transaction (status: completed), create Receipt
  Celery->>Channels: push anomaly/receipt events
  Channels->>Frontend: notify (receipt ready / anomaly)
  Frontend->>Attendant: Display receipt + alerts
